angular.module("RDash",["ui.bootstrap","ui.router","ngCookies"]);
"use strict";angular.module("RDash").config(["$stateProvider","$urlRouterProvider",function(t,l){l.otherwise("/admin"),t.state("tables",{url:"/tables",templateUrl:"public/admin/tables.html"}).state("admin",{url:"/admin",topName:"Admin Setup",path:"Home / Admin",templateUrl:"/public/admin/templates/admin.html"}).state("country",{url:"/country",topName:"Country Setup",templateUrl:"/public/admin/templates/admin/country.html",controller:"CountryCtrl"}).state("clinic",{url:"/clinic",topName:"Clinic Setup",templateUrl:"/public/admin/templates/admin/clinic.html",controller:"ClinicCtrl"}).state("order",{url:"/order",templateUrl:"/public/admin/templates/order.html",controller:"OrderCtrl"}).state("tax",{url:"/tax",templateUrl:"/public/admin/templates/admin/tax.html",controller:"TaxCtrl"}).state("vendor",{url:"/vendor",templateUrl:"/public/admin/templates/admin/vendor.html",controller:"VendorCtrl"}).state("reports",{url:"/reports",templateUrl:"/public/admin/templates/reports.html"}).state("low_stock",{url:"/low_stock",templateUrl:"/public/admin/templates/reports/low-stock.html",controller:"LowStockCtrl"}).state("product",{url:"/product",templateUrl:"/public/admin/templates/product.html",controller:"ProductCtrl"})}]);
"use strict";function AlertsCtrl(t,o){t.alerts=[],t.config={endPoint:"/reports/low_stock/"},t.addAlert=function(o){t.alerts.push({type:o.type,msg:o.msg})},t.closeAlert=function(o){t.alerts.splice(o,1)},t.reloadLowStockList=function(){o.get(t.config.endPoint).success(function(o,e,r,l){t.products=o,t.alerts=[];for(var n=0;n<o.length;n++){var s=o[n].clinic_name+" is low on "+o[n].name;t.addAlert({type:"danger",msg:s})}})},t.$on("reloadLowStockAlert",function(){t.reloadLowStockList()}),t.reloadLowStockList()}angular.module("RDash").controller("AlertsCtrl",["$scope","$http",AlertsCtrl]);
"use strict";function ClinicCtrl(n,i,e,t,o,c){n.config={"new":"Add Clinic",modify:"Modify Clinic",modalSize:"",templateUrl:"clinic.html",controller:"ModalClinicCtrl",endPoint:"/admin/clinic/",endPointCountry:"/admin/country/"},n.selected="",n.$state=i,n.sortType="name",n.sortReverse=!1,n.reloadClinicList=function(){e.get(n.config.endPoint).success(function(i,e,t,o){n.clinics=i})},n.reloadCountryList=function(){e.get(n.config.endPointCountry).success(function(i,e,t,o){n.countries=i})},n.modify=function(i){n.openModal(i,n.config.modify)},n["new"]=function(){n.openModal("",n.config["new"])},n["delete"]=function(i){var t=n.config.endPoint;t+=i.clinic_id+"/",e({url:t,method:"DELETE",data:{}}).then(function(e){"fail"!=e.data.status?(n.reloadClinicList(),c.displayFlashMessage("Clinic deleted: "+i.name+" at country "+i.country_name)):alert(e.data.message)},function(n){alert("Failed to delete clinic: "+i.name)})},n.openModal=function(i,e){var l=t.open({animation:n.animationsEnabled,templateUrl:n.config.templateUrl,controller:n.config.controller,size:n.config.modalSize,resolve:{clinic:function(){return i},action:function(){return e},config:function(){return n.config},countries:function(){return n.countries}}});l.result.then(function(e){n.reloadClinicList(),e==n.config["new"]?c.displayFlashMessage("Clinic added"):c.displayFlashMessage("Clinic modfied: "+i.name)},function(){o.info("Modal dismissed at: "+new Date)})},n.reloadClinicList(),n.reloadCountryList()}function ModalClinicCtrl(n,i,e,t,o,c,l){n.action=o,n.selected=t,n.countries=l,n.ok=function(){var l="";if(""===n.selected.name&&(l+="Clinic name cannot be empty\n"),""==l){var a=c.endPoint;t.hasOwnProperty("clinic_id")&&(a+=t.clinic_id+"/"),e({url:a,method:"POST",data:{clinic:n.selected}}).then(function(n){"fail"!=n.data.status?i.close(o):alert(n.data.message)},function(n){alert("Failed to insert/update clinic")})}else alert(l)},n.cancel=function(){i.dismiss("cancel")}}angular.module("RDash").controller("ClinicCtrl",["$scope","$state","$http","$modal","$log","LowStockService",ClinicCtrl]),angular.module("RDash").controller("ModalClinicCtrl",["$scope","$modalInstance","$http","clinic","action","config","countries",ModalClinicCtrl]);
"use strict";function CountryCtrl(t,e,n,o,l,r){t.config={"new":"Add Country",modify:"Modify Country",deleteAction:"Are you sure you want to delete this Country?",modalSize:"sm",templateUrl:"country.html",templateUrlDelete:"country-delete.html",controller:"ModalCountryCtrl",controllerDelete:"ModalCountryCtrlDelete",endPoint:"/admin/country/"},t.sortType="name",t.sortReverse=!1,t.selected="",t.$state=e,t.reloadCountryList=function(){n.get(t.config.endPoint).success(function(e,n,o,l){t.countries=e})},t.modify=function(e){t.openModal(e,t.config.modify)},t["new"]=function(){t.openModal("",t.config["new"])},t["delete"]=function(e){var n=o.open({animation:t.animationsEnabled,templateUrl:t.config.templateUrlDelete,controller:t.config.controllerDelete,size:t.config.modalSize,resolve:{country:function(){return e},config:function(){return t.config}}});n.result.then(function(){t.reloadCountryList(),r.displayFlashMessage("Country setup deleted: "+e.name)},function(){l.info("Modal dismissed at: "+new Date)})},t.openModal=function(e,n){var a=o.open({animation:t.animationsEnabled,templateUrl:t.config.templateUrl,controller:t.config.controller,size:t.config.modalSize,resolve:{country:function(){return e},action:function(){return n},config:function(){return t.config}}});a.result.then(function(n){t.reloadCountryList(),n==t.config["new"]?r.displayFlashMessage("Country added"):r.displayFlashMessage("Country modfied: "+e.name)},function(){l.info("Modal dismissed at: "+new Date)})},t.reloadCountryList()}function ModalCountryCtrl(t,e,n,o,l,r){t.action=l,t.selected=o,t.ok=function(){var a="";if(""===t.selected.name&&(a+="Country name cannot be empty\n"),""===t.selected.currency&&(a+="Currency name cannot be empty\n"),""==a){var c=r.endPoint;o.hasOwnProperty("country_id")&&(c+=o.country_id+"/"),n({url:c,method:"POST",data:{country:t.selected}}).then(function(t){"fail"!=t.data.status?e.close(l):alert(t.data.message)},function(t){alert("Failed to insert/update country")})}else alert(a)},t.cancel=function(){e.dismiss("cancel")}}function ModalCountryCtrlDelete(t,e,n,o,l){t.deleteAction=l.deleteAction,t.ok=function(){var t=l.endPoint;t+=o.country_id+"/",n({url:t,method:"DELETE",data:{}}).then(function(t){"fail"!=t.data.status?e.close():alert(t.data.message)},function(t){alert("Failed to delete country: "+o.name)})},t.cancel=function(){e.dismiss("cancel")}}angular.module("RDash").controller("CountryCtrl",["$scope","$state","$http","$modal","$log","LowStockService",CountryCtrl]),angular.module("RDash").controller("ModalCountryCtrl",["$scope","$modalInstance","$http","country","action","config",ModalCountryCtrl]),angular.module("RDash").controller("ModalCountryCtrlDelete",["$scope","$modalInstance","$http","country","config",ModalCountryCtrlDelete]);
"use strict";function LowStockCtrl(t,o,n,c,e){t.config={endPoint:"/reports/low_stock/"},t.selected="",t.$state=o,t.sortType="quantity_on_hand",t.sortReverse=!1,t.reloadLowStockList=function(){n.get(t.config.endPoint).success(function(o,n,c,e){t.products=o,angular.forEach(t.products,function(t){t.quantity_on_hand=parseFloat(t.quantity_on_hand)})})},t.reloadLowStockList()}angular.module("RDash").controller("LowStockCtrl",["$scope","$state","$http","$modal","$log",LowStockCtrl]);
"use strict";function MasterCtrl(e,t,o,a){e.$state=o,e.systemName="SMS v2",e.flashMessage="";var s=992;e.getWidth=function(){return window.innerWidth},e.selected="",e.$watch(e.getWidth,function(o,a){o>=s?angular.isDefined(t.get("toggle"))?e.toggle=t.get("toggle")?!0:!1:e.toggle=!0:e.toggle=!1}),e.toggleSidebar=function(){e.toggle=!e.toggle,t.put("toggle",e.toggle)},e.$on("displayFlashMessage",function(t,o){e.displayFlashMessage(o.msg)}),e.displayFlashMessage=function(t){e.flashMessage=t},window.onresize=function(){e.$apply()}}function LowStockService(e){var t={};return t.reloadLowStockAlert=function(){e.$broadcast("reloadLowStockAlert")},t.displayFlashMessage=function(t){e.$broadcast("displayFlashMessage",{msg:t})},t}angular.module("RDash").controller("MasterCtrl",["$scope","$cookieStore","$state","$http",MasterCtrl]),angular.module("RDash").factory("LowStockService",["$rootScope",LowStockService]);
"use strict";function OrderCtrl(e,n,r,t,o,i){e.config={"new":"Add Order",modify:"Modify Order",modalSize:"",templateUrl:"order.html",quantity_on_hand:5,controller:"ModalOrderCtrl",endPoint:"/admin/orders/",endPointVendor:"/admin/vendor/",endPointTax:"/admin/tax_with_currency/",endPointClinic:"/admin/clinic",endPointClinicProduct:"/admin/product_by_clinic_id/",endPointOrderLine:"/admin/orders_line/"},e.selected="",e.$state=n,e.sortType="stock_order_id",e.sortReverse=!0,e.reloadOrdersList=function(){r.get(e.config.endPoint).success(function(n,r,t,o){e.orders=n})},e.reloadVendorsList=function(){r.get(e.config.endPointVendor).success(function(n,r,t,o){e.vendors=n})},e.reloadTaxList=function(){r.get(e.config.endPointTax).success(function(n,r,t,o){e.tax=n})},e.reloadClinicList=function(){r.get(e.config.endPointClinic).success(function(n,r,t,o){e.clinics=n})},e.modify=function(n){e.openModal(n,e.config.modify)},e["new"]=function(){e.openModal("",e.config["new"])},e["delete"]=function(n){var t=e.config.endPoint;t+=n.stock_order_id+"/",r({url:t,method:"DELETE",data:{}}).then(function(n){"fail"!=n.data.status?(e.reloadOrdersList(),i.displayFlashMessage("Order deleted")):alert(n.data.message)},function(e){alert("Failed to delete order: "+n.stock_order_id)})},e.openModal=function(n,r){var d=t.open({animation:e.animationsEnabled,templateUrl:e.config.templateUrl,controller:e.config.controller,size:e.config.modalSize,resolve:{order:function(){return n},action:function(){return r},config:function(){return e.config},vendors:function(){return e.vendors},tax:function(){return e.tax},clinic:function(){return e.clinics}}});d.result.then(function(n){e.reloadOrdersList(),i.reloadLowStockAlert(),n==e.config["new"]?i.displayFlashMessage("Order added"):i.displayFlashMessage("Order modfied")},function(){e.reloadOrdersList(),o.info("Modal dismissed at: "+new Date)})},e.reloadOrdersList(),e.reloadVendorsList(),e.reloadTaxList(),e.reloadClinicList()}function ModalOrderCtrl(e,n,r,t,o,i,d,a,c){e.action=o,e.selected=t,e.ordersLines=[],e.currentOrderLine=t.orderLines,e.vendors=d,e.tax=a,e.newOrderLine=function(){e.ordersLines.push({quantity_on_hand:i.quantity_on_hand,clinics:c})},e.removeOrderLine=function(e,n){n.splice(e,1)},e.removeAllOrderLine=function(n,o){var d=i.endPointOrderLine;d+=t.stock_order_id+"/",r({url:d,method:"DELETE",data:{}}).then(function(n){"fail"!=n.data.status?e.currentOrderLine=[]:alert(n.data.message)},function(e){alert("Failed to delete orderline")})},e.getProductsByClinic=function(n,t,o){e.ordersLines[t].products="";var d=i.endPointClinicProduct;d+=n+"/",r.get(d).success(function(n,r,o,i){e.ordersLines[t].products=n})},e.ok=function(){var d=i.endPoint;t.hasOwnProperty("stock_order_id")&&(d+=t.stock_order_id+"/"),r({url:d,method:"POST",data:{order:e.selected,orderlines:e.ordersLines,currentlines:e.currentOrderLine}}).then(function(e){"fail"!=e.data.status?n.close(o):alert(e.data.message)},function(e){alert("Failed to insert/update order")})},e.cancel=function(){n.dismiss("cancel")}}angular.module("RDash").controller("OrderCtrl",["$scope","$state","$http","$modal","$log","LowStockService",OrderCtrl]),angular.module("RDash").controller("ModalOrderCtrl",["$scope","$modalInstance","$http","order","action","config","vendors","tax","clinic",ModalOrderCtrl]);
"use strict";function ProductCtrl(t,o,n,c,e,i){t.config={"new":"Add Product Per Clinic",modify:"Modify Product",modalSize:"sm",templateUrl:"product.html",controller:"ModalProductCtrl",endPoint:"/reports/product/",endPointClinic:"/admin/clinic/"},t.selected="",t.$state=o,t.sortType="quantity_on_hand",t.sortReverse=!1,t.reloadProductList=function(){n.get(t.config.endPoint).success(function(o,n,c,e){t.products=o,angular.forEach(t.products,function(t){t.quantity_on_hand=parseFloat(t.quantity_on_hand)})})},t.reloadClinicList=function(){n.get(t.config.endPointClinic).success(function(o,n,c,e){t.clinics=o})},t.modify=function(o){t.openModal(o,t.config.modify)},t["new"]=function(){t.openModal("",t.config["new"])},t["delete"]=function(o){var c=t.config.endPoint;c+=o.product_id+"/",n({url:c,method:"DELETE",data:{}}).then(function(o){"fail"!=o.data.status?t.reloadProductList():alert(o.data.message)},function(t){alert("Failed to delete Product: "+o.name)})},t.openModal=function(o,n){var r=c.open({animation:t.animationsEnabled,templateUrl:t.config.templateUrl,controller:t.config.controller,size:t.config.modalSize,resolve:{product:function(){return o},action:function(){return n},config:function(){return t.config},clinic:function(){return t.clinics}}});r.result.then(function(o){t.reloadProductList(),i.reloadLowStockAlert()},function(){e.info("Modal dismissed at: "+new Date)})},t.reloadProductList(),t.reloadClinicList()}function ModalProductCtrl(t,o,n,c,e,i,r){t.action=e,t.selected=c,t.clinics=r,t.ok=function(){var e=i.endPoint;c.hasOwnProperty("product_id")&&(e+=c.product_id+"/"),n({url:e,method:"POST",data:{product:t.selected}}).then(function(t){"fail"!=t.data.status?o.close():alert(t.data.message)},function(t){alert("Failed to insert/update product")})},t.cancel=function(){o.dismiss("cancel")}}angular.module("RDash").controller("ProductCtrl",["$scope","$state","$http","$modal","$log","LowStockService",ProductCtrl]),angular.module("RDash").controller("ModalProductCtrl",["$scope","$modalInstance","$http","product","action","config","clinic",ModalProductCtrl]);
"use strict";function TaxCtrl(e,t,n,a,o,i){e.config={"new":"Add Tax For Country",modify:"Modify Tax Setup",modalSize:"sm",templateUrl:"tax.html",controller:"ModalTaxCtrl",endPoint:"/admin/tax/",endPointCountry:"/admin/country/"},e.selected="",e.$state=t,e.sortType="country_name",e.sortReverse=!1,e.reloadTaxList=function(){n.get(e.config.endPoint).success(function(t,n,a,o){e.tax=t,angular.forEach(e.tax,function(e){e.percent=parseFloat(e.percent)})})},e.reloadCountryList=function(){n.get(e.config.endPointCountry).success(function(t,n,a,o){e.countries=t})},e.modify=function(t){e.openModal(t,e.config.modify)},e["new"]=function(){e.openModal("",e.config["new"])},e["delete"]=function(t){var a=e.config.endPoint;a+=t.tax_id+"/",n({url:a,method:"DELETE",data:{}}).then(function(n){"fail"!=n.data.status?(e.reloadTaxList(),i.displayFlashMessage("Tax setup deleted for Country "+t.country_name)):alert(n.data.message)},function(e){alert("Failed to delete Tax Setup: "+t.country_name)})},e.openModal=function(t,n){var r=a.open({animation:e.animationsEnabled,templateUrl:e.config.templateUrl,controller:e.config.controller,size:e.config.modalSize,resolve:{tax:function(){return t},action:function(){return n},config:function(){return e.config},countries:function(){return e.countries}}});r.result.then(function(a){e.reloadTaxList(),n==e.config["new"]?i.displayFlashMessage("Tax setup added"):i.displayFlashMessage("tax setup modified for Country "+t.country_name)},function(){o.info("Modal dismissed at: "+new Date)})},e.reloadTaxList(),e.reloadCountryList()}function ModalTaxCtrl(e,t,n,a,o,i,r){e.action=o,e.selected=a,e.countries=r,e.ok=function(){var r="";if((e.selected.percent.length>3||e.selected.percent>100)&&(r+="Percent value must be smaller than 100\n"),e.selected.percent<0&&(r+="Percent value must be larger than 0\n"),isNaN(parseFloat(e.selected.percent))&&!isFinite(e.selected.percent)&&(r+="Percent value must contain numbers"),""==r){var l=i.endPoint;a.hasOwnProperty("tax_id")&&(l+=a.tax_id+"/"),n({url:l,method:"POST",data:{tax:e.selected}}).then(function(e){"fail"!=e.data.status?t.close(o):alert(e.data.message)},function(e){alert("Failed to insert/update tax setup")})}else alert(r)},e.cancel=function(){t.dismiss("cancel")}}angular.module("RDash").controller("TaxCtrl",["$scope","$state","$http","$modal","$log","LowStockService",TaxCtrl]),angular.module("RDash").controller("ModalTaxCtrl",["$scope","$modalInstance","$http","tax","action","config","countries",ModalTaxCtrl]);
"use strict";function VendorCtrl(e,n,o,t,a,d){e.config={"new":"Add Vendor",modify:"Modify Vendor",modalSize:"",templateUrl:"vendor.html",controller:"ModalVendorCtrl",endPoint:"/admin/vendor/"},e.selected="",e.$state=n,e.sortReverse=!1,e.sortType="name",e.reloadVendorList=function(){o.get(e.config.endPoint).success(function(n,o,t,a){e.vendors=n})},e.modify=function(n){e.openModal(n,e.config.modify)},e["new"]=function(){e.openModal("",e.config["new"])},e["delete"]=function(n){var t=e.config.endPoint;t+=n.vendor_id+"/",o({url:t,method:"DELETE",data:{}}).then(function(o){"fail"!=o.data.status?(e.reloadVendorList(),d.displayFlashMessage("Vendor deleted: "+n.name)):alert(o.data.message)},function(e){alert("Failed to delete Vendor Setup: "+n.name)})},e.openModal=function(n,o){var i=t.open({animation:e.animationsEnabled,templateUrl:e.config.templateUrl,controller:e.config.controller,size:e.config.modalSize,resolve:{vendor:function(){return n},action:function(){return o},config:function(){return e.config}}});i.result.then(function(o){e.reloadVendorList(),o==e.config["new"]?d.displayFlashMessage("Vendor added"):d.displayFlashMessage("Vendor modified: "+n.name)},function(){a.info("Modal dismissed at: "+new Date)})},e.reloadVendorList()}function ModalVendorCtrl(e,n,o,t,a,d){e.action=a,e.selected=t,e.validateEmail=function(e){var n=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return n.test(e)},e.ok=function(){var i="";if(""==e.selected.name&&(i+="Name cannot be empty\n"),e.validateEmail(e.selected.email)||(i+="Valid email address in format foo@example.com"),""==i){var l=d.endPoint;t.hasOwnProperty("vendor_id")&&(l+=t.vendor_id+"/"),o({url:l,method:"POST",data:{vendor:e.selected}}).then(function(e){"fail"!=e.data.status?n.close(a):alert(e.data.message)},function(e){alert("Failed to insert/update vendor setup")})}else alert(i)},e.cancel=function(){n.dismiss("cancel")}}angular.module("RDash").controller("VendorCtrl",["$scope","$state","$http","$modal","$log","LowStockService",VendorCtrl]),angular.module("RDash").controller("ModalVendorCtrl",["$scope","$modalInstance","$http","vendor","action","config",ModalVendorCtrl]);
function rdLoading(){var d={restrict:"AE",template:'<div class="loading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>'};return d}angular.module("RDash").directive("rdLoading",rdLoading);
function rdWidgetBody(){var d={requires:"^rdWidget",scope:{loading:"@?",classes:"@?"},transclude:!0,template:'<div class="widget-body" ng-class="classes"><rd-loading ng-show="loading"></rd-loading><div ng-hide="loading" class="widget-content" ng-transclude></div></div>',restrict:"E"};return d}angular.module("RDash").directive("rdWidgetBody",rdWidgetBody);
function rdWidgetFooter(){var e={requires:"^rdWidget",transclude:!0,template:'<div class="widget-footer" ng-transclude></div>',restrict:"E"};return e}angular.module("RDash").directive("rdWidgetFooter",rdWidgetFooter);
function rdWidgetTitle(){var i={requires:"^rdWidget",scope:{title:"@",icon:"@"},transclude:!0,template:'<div class="widget-header"><div class="row"><div class="pull-left"><i class="fa" ng-class="icon"></i> {{title}} </div><div class="pull-right col-xs-6 col-sm-4" ng-transclude></div></div></div>',restrict:"E"};return i}angular.module("RDash").directive("rdWidgetHeader",rdWidgetTitle);
function rdWidget(){var d={transclude:!0,template:'<div class="widget" ng-transclude></div>',restrict:"EA"};return d}angular.module("RDash").directive("rdWidget",rdWidget);